<!-- templates/dashboard.html -->
{% extends "layout.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
    <h1>Consultar Registros de Atendimento</h1>
    <form action="{{ url_for('view_attendance') }}" method="GET">
        <label for="city">Cidade:</label>
        <select class="form-select" name="city" id="city" required>
            {% for city in cities %}
            <option value="{{ city }}">{{ city }}</option>
            {% endfor %}
        </select>
        <br>
        <label for="date">Data:</label>
        <input class="form-control" type="date" name="date" id="date" required>
        <br>
        <div align="center">
        <input class="btn btn-primary" type="submit" value="Consultar" style="width: 80%;">
        </div>
    </form>
    <script src="https://cdn.jsdelivr.net/npm/luxon@3/build/global/luxon.min.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            // Usando Luxon para lidar com o fuso horário
            const DateTime = luxon.DateTime;

            // Obtenha a data atual no fuso horário de São Paulo
            const nowInSaoPaulo = DateTime.now().setZone('America/Sao_Paulo');

            // Formate a data para 'YYYY-MM-DD'
            const formattedDate = nowInSaoPaulo.toFormat('yyyy-MM-dd');

            // Obtenha o elemento de entrada da data
            const dateInput = document.getElementById('date');

            // Defina o valor do campo de data para a data atual em São Paulo
            dateInput.value = formattedDate;
        });
    </script>
{% endblock %}